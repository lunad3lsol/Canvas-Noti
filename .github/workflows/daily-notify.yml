name: Daily Canvas Notification

on:
  schedule:
    # Runs every day at 8:00 AM UTC â€” adjust to your timezone
    # Examples:
    #   "0 8 * * *"  = 8:00 AM UTC  (3:00 AM EST / 12:00 AM PST)
    #   "0 13 * * *" = 1:00 PM UTC  (8:00 AM EST / 5:00 AM PST)
    #   "0 16 * * *" = 4:00 PM UTC  (11:00 AM EST / 8:00 AM PST)
    - cron: "0 13 * * *"

  # Allows you to run it manually from the GitHub Actions tab
  workflow_dispatch:

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: pip install -r requirements.txt

      - name: Run Canvas notifier
        env:
          CANVAS_API_URL: ${{ secrets.CANVAS_API_URL }}
          CANVAS_API_TOKEN: ${{ secrets.CANVAS_API_TOKEN }}
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
          DAYS_AHEAD: ${{ secrets.DAYS_AHEAD || '7' }}
          NOTIFY_ASSIGNMENTS: ${{ secrets.NOTIFY_ASSIGNMENTS || 'true' }}
          NOTIFY_DISCUSSIONS: ${{ secrets.NOTIFY_DISCUSSIONS || 'true' }}
        run: python canvas_notifier.py
